# Results




```{r missing-smus-table, echo=FALSE}
library(dplyr)
library(knitr)

source("testingTables.R")
source("tableCreation.R")

# Identify missing SMUs
missing_smus <- fullList %>%
  filter(!smu %in% unique(cu_outlook_records_enriched$smu_name)) %>%
  distinct(area, species, smu)

# Check and display
if (nrow(missing_smus) == 0) {
  knitr::kable(data.frame(Message = "All SMUs are accounted for in the survey results."))
} else {
  missing_smus %>%
    arrange(area, species, smu) %>%
    knitr::kable(col.names = c("Area", "Species", "Missing SMU"),
                 caption = "Missing SMUs grouped by Area and Species")
}


```


## Identify Missing CUs

```{r missing-cu, echo = F}
# Step 1: Get CUs from tabPrep where Resolution is CU or CU (aggregate)
cu_rows <- tabPrep %>%
  filter(Resolution %in% c("CU (singular)", "CU (aggregate)"))

# Extract CU names (split aggregates by comma, no space)
reported_cus <- cu_rows$Name %>%
  strsplit(split = ",") %>%
  unlist() %>%
  unique()

# Step 2: Get SMUs from tabPrep where Resolution is SMU
smu_rows <- tabPrep %>%
  filter(Resolution == "SMU")

# Get associated CUs from fullList for those SMUs
excluded_cus <- fullList %>%
  filter(smu %in% smu_rows$Name) %>%
  pull(cu) %>%
  unique()

# Step 3: Get reference CUs from fullList, excluding those tied to SMUs
reference_cus <- fullList %>%
  filter(!cu %in% excluded_cus) %>%
  pull(cu) %>%
  unique()

# Step 4: Identify missing CUs
missing_cus <- setdiff(reference_cus, reported_cus)

# Step 5: Display results
if (length(missing_cus) == 0) {
  knitr::kable(data.frame(Message = "All CUs are accounted for in the survey results."))
} else {
  data.frame(`Missing CU` = sort(missing_cus)) %>%
    knitr::kable(caption = "Missing CUs from the survey results")
}
```


## Fraser and Interior Area

### Chum

```{r fiaChumTable, results = "asis"}

ft = tryCatch(
  make_table("FRASER AND INTERIOR", "Chum"),
  error = function(e){
    print("No data for this species/area combination.")
    return(NULL)
  }
)

if(!is.null(ft)){
  ft
}

```



### Chinook

```{r fiaChinookTable}

make_table("FRASER AND INTERIOR", "Chinook")


```


### Coho

### Pink-Even

### Sockeye Lake-Type

### Sockeye River-Type

## North Coast Area

### Chum

### Chinook

### Coho

### Pink-Even

### Sockeye Lake-Type

### Sockeye River-Type

## South Coast Area

### Chum

```{r scChumTable}

make_table("SOUTH COAST", "Chum")


```




```{r tableTest2, results = "asis"}


#ftSMU

```



### Chinook

### Coho

### Pink-Even

### Sockeye (Lake Type)

```{r scsockeyLTTable}

make_table("SOUTH COAST", "Sockeye (Lake Type)")


```

### Sockeye (River Type)





## Yukon Transboundary

### Chum

### Chinook

### Coho

### Pink-Even

### Sockeye Lake-Type

### Sockeye River-Type
